-- LocalScript inside StarterPlayer -> StarterPlayerScripts

local player = game.Players.LocalPlayer
local playerGui = player.PlayerGui
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local ChatService = game:GetService("Chat")

-- Create the UI
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = playerGui
screenGui.Name = "HonoredOneUI"

local button = Instance.new("TextButton")
button.Parent = screenGui
button.Size = UDim2.new(0, 200, 0, 50)
button.Position = UDim2.new(0.5, -100, 0.5, -25)
button.Text = "The Honored One"
button.TextSize = 20

-- Create RemoteEvent in ReplicatedStorage if it doesn't exist
local honoredEvent = ReplicatedStorage:FindFirstChild("HonoredEvent")
if not honoredEvent then
    honoredEvent = Instance.new("RemoteEvent")
    honoredEvent.Name = "HonoredEvent"
    honoredEvent.Parent = ReplicatedStorage
end

-- Function to handle button click and trigger the server-side logic
button.MouseButton1Click:Connect(function()
    honoredEvent:FireServer()  -- Fire event to the server when the button is clicked
end)

-- Server-side script (to be placed in ServerScriptService)
-- This part of the script must be inside a regular Script in ServerScriptService

local function honorPlayer(player)
    -- Ensure the player has a character and humanoid
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        local humanoid = player.Character.Humanoid
        local rootPart = player.Character:WaitForChild("HumanoidRootPart")
        
        -- Make sure the character is not already being honored
        if not player.Character:FindFirstChild("HonoredEffect") then
            local honoredEffect = Instance.new("BoolValue")
            honoredEffect.Name = "HonoredEffect"
            honoredEffect.Parent = player.Character

            -- Lift player into the air (using Tween for smooth movement)
            local originalPosition = rootPart.Position
            local targetPosition = originalPosition + Vector3.new(0, 10, 0)  -- Raise 10 studs up

            -- Tween the player upwards
            TweenService:Create(rootPart, TweenInfo.new(1), {Position = targetPosition}):Play()

            -- Lay the player flat (by setting the humanoid's 'Sit' property to true and adjusting their orientation)
            humanoid.Sit = true
            humanoid.PlatformStand = true  -- Disable character's movement while "floating"

            -- Wait a bit before saying the message
            wait(1)

            -- Player says the message
            ChatService:Chat(player.Character, "I alone am the honored one!", Enum.ChatColor.Red)

            -- Wait for 5 seconds while the player is floating
            wait(5)

            -- Bring the player back down
            TweenService:Create(rootPart, TweenInfo.new(1), {Position = originalPosition}):Play()

            -- Stop the sitting animation and allow movement again
            wait(1)
            humanoid.Sit = false
            humanoid.PlatformStand = false

            -- Clean up the effect
            honoredEffect:Destroy()
        end
    end
end

-- Listen for the event to trigger the honor effect
honoredEvent.OnServerEvent:Connect(honorPlayer)
